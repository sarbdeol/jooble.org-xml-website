{% extends "base.html" %}
{% block content %}
<h3 class="mb-3">Setup Job Feed</h3>

<form method="POST" novalidate>
  <div class="row g-3">
    <div class="col-md-8">
      <label class="form-label">Incoming Feed URL</label>
      <input
        name="feed_url"
        type="url"
        class="form-control"
        placeholder="https://example.com/jobs.xml"
        value="{{ config.feed_url or '' }}"
        required
      >
      <div class="form-text">Public XML feed URL to fetch once per run.</div>
    </div>

    <div class="col-md-4">
      <label class="form-label">Interval (hours)</label>
      <input
        name="interval"
        type="number"
        min="1"
        max="8760"
        class="form-control"
        value="{{ config.interval or 1 }}"
        required
      >
      <div class="form-text">How often to re-run (1–8760).</div>
    </div>
    <div class="col-md-4">
      <label class="form-label">Base Slug</label>
      <input
        name="base_slug"
        type="text"
        class="form-control"
        value="{{ config.base_slug or 'stellenonline' }}"
        placeholder="stellenonline"
      >
      <div class="form-text">Public path: /{{ config.base_slug or 'stellenonline' }}/&lt;profile&gt;</div>
    </div>

  </div>

  <button class="btn btn-success mt-3" type="submit">Save & Run Now</button>
  <a class="btn btn-outline-light mt-3 ms-2" href="{{ url_for('profiles') }}">Manage Profiles (CPC ranges)</a>
</form>

<hr class="my-4"/>

<div class="row g-3">
  <div class="col-md-4">
    <div class="card p-3">
      <div class="small text-muted">Current Feed URL</div>
      <div class="stat-value text-break">{{ config.feed_url or "—" }}</div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <div class="small text-muted">Next Run</div>
      <div class="stat-value">{{ config.next_run or "—" }}</div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <div class="small text-muted">Profiles Configured</div>
      <div class="stat-value">{{ profiles|length if profiles is defined else "—" }}</div>
    </div>
  </div>
</div>
{% endblock %}
