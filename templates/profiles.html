{% extends "base.html" %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h3 class="mb-0">Profiles (Outgoing XMLs)</h3>
  <a class="btn btn-outline-light" href="{{ url_for('dashboard') }}">Back to Dashboard</a>
</div>

<div class="row g-3">
  <div class="col-md-6">
    <div class="card p-3">
      <h5 class="mb-3">Add Profile</h5>
      <form method="POST">
        <div class="mb-3">
          <label class="form-label">Slug</label>
          <input name="slug" class="form-control" placeholder="e.g. xml1" required>
          <div class="form-text">Public URL: <code>{{ request.url_root.rstrip('/') }}/{{ base_slug if base_slug else 'stellenonline' }}/&lt;slug&gt;</code></div>
        </div>
        <div class="mb-3">
          <label class="form-label">CPC Min</label>
          <input name="cpc_min" type="number" step="0.01" min="0" class="form-control" placeholder="0.01" required>
        </div>
        <div class="mb-3">
          <label class="form-label">CPC Max (optional)</label>
          <input name="cpc_max" type="number" step="0.01" min="0" class="form-control" placeholder="leave blank = no max">
        </div>
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="is_enabled" name="is_enabled" checked>
          <label class="form-check-label" for="is_enabled">Enabled</label>
        </div>
        <button class="btn btn-success" type="submit">Create</button>
      </form>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card p-3">
      <h5 class="mb-3">Existing Profiles</h5>
      {% if profiles and profiles|length > 0 %}
        <div class="table-responsive">
          <table class="table table-dark table-striped align-middle mb-0">
            <thead>
              <tr>
                <th>ID</th>
                <th>Slug</th>
                <th>Range</th>
                <th>Enabled</th>
                <th>Delete</th>
              </tr>
            </thead>
            <tbody>
            {% for p in profiles %}
              <tr>
                <td>{{ p[0] }}</td>
                <td><code>{{ p[1] }}</code></td>
                <td>{{ p[2] }} â€“ {{ p[3] if p[3] is not none else "No max" }}</td>
                <td>{{ "Yes" if p[4] else "No" }}</td>
                <td>
                  <form method="POST" action="{{ url_for('delete_profile', pid=p[0]) }}" onsubmit="return confirm('Delete profile {{ p[1] }}?');">
                    <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div>No profiles yet.</div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
